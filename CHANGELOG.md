Refactoring and optimization iteration 1
