Refactoring and optimization iteration 1
Refactoring and optimization iteration 2
